!function(a){a.fn.bl_checkbox_submit=function(b){return this.each(function(){function c(a){h.prop("checked",a),i.toggleClass("checked",a),a?(e.find("input[name=_method]").val("delete"),j.text(e.attr("data-present"))):(e.find("input[name=_method]").val("put"),j.text(e.attr("data-absent")))}var d=a.extend({},a.fn.bl_checkbox_submit.defaults,b),e=a(this);e.children().hide(),e.find("input[type=submit]").remove(),e.addClass("form-horizontal");var f=e.attr("data-doc-id")||Math.random(),g=0!=e.find("input[name=_method][value=delete]").size(),h=a('<input type="checkbox">').addClass(d.css_class).attr("id",d.css_class+"_"+f),i=a("<label>").addClass(d.css_class).attr("for",d.css_class+"_"+f).attr("title",e.attr("title")||""),j=a("<span>");i.append(h),i.append(" "),i.append(j);var k=a("<div class='checkbox' />").addClass(d.css_class).append(i);e.append(k),c(g),h.click(function(){return j.text(e.attr("data-inprogress")),i.attr("disabled","disabled"),h.attr("disabled","disabled"),a.ajax({url:e.attr("action"),dataType:"json",type:e.attr("method").toUpperCase(),data:e.serialize(),error:function(){alert("Error"),c(g),i.removeAttr("disabled"),h.removeAttr("disabled")},success:function(a,b,f){0!=f.status?(g=!g,c(g),i.removeAttr("disabled"),h.removeAttr("disabled"),d.success.call(e,g,f.responseJSON)):(alert("Error"),c(g),i.removeAttr("disabled"),h.removeAttr("disabled"))}}),!1})}),this},a.fn.bl_checkbox_submit.defaults={css_class:"bl_checkbox_submit",success:function(){}}}(jQuery);