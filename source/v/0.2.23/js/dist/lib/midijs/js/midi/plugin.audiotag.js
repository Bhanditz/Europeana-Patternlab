!function(a){"use strict";window.Audio&&function(){for(var b=a.AudioTag={api:"audiotag"},c={},d=127,e=-1,f=[],g=[],h={},i=0;12>i;i++)f[i]=new Audio;var j=function(b,c){if(a.channels[b]){var i=a.channels[b].instrument,j=a.GM.byId[i].id,c=h[c];if(c){var k=j+""+c.id,l=(e+1)%f.length,m=f[l];if(g[l]=k,!a.Soundfont[j])return void(a.DEBUG&&console.log("404",j));m.src=a.Soundfont[j][c.id],m.volume=d/127,m.play(),e=l}}},k=function(b,c){if(a.channels[b]){var d=a.channels[b].instrument,i=a.GM.byId[d].id,c=h[c];if(c)for(var j=i+""+c.id,k=0,l=f.length;l>k;k++){var m=(k+e+1)%l,n=g[m];if(n&&n==j)return f[m].pause(),void(g[m]=null)}}};b.audioBuffers=f,b.send=function(a,b){},b.setController=function(a,b,c,d){},b.setVolume=function(a,b){d=b},b.programChange=function(b,c){a.channels[b].instrument=c},b.pitchBend=function(a,b,c){},b.noteOn=function(a,b,d,e){var f=c[b];if(h[f])return e?setTimeout(function(){j(a,f)},1e3*e):void j(a,f)},b.noteOff=function(a,b,c){},b.chordOn=function(a,b,d,e){for(var f=0;f<b.length;f++){var g=b[f],i=c[g];if(h[i]){if(e)return setTimeout(function(){j(a,i)},1e3*e);j(a,i)}}},b.chordOff=function(a,b,d){for(var e=0;e<b.length;e++){var f=b[e],g=c[f];if(h[g]){if(d)return setTimeout(function(){k(a,g)},1e3*d);k(a,g)}}},b.stopAllNotes=function(){for(var a=0,b=f.length;b>a;a++)f[a].pause()},b.connect=function(d){a.setDefaultPlugin(b);for(var e in a.keyToNote)c[a.keyToNote[e]]=e,h[e]={id:e};d.onsuccess&&d.onsuccess()}}()}(MIDI);