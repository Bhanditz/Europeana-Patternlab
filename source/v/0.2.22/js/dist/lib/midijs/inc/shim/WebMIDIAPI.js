!function(a){"use strict";function b(){}function c(){this.inputInUse=!1,this.outputInUse=!1;var a=document.createElement("object");a.id="_Jazz"+Math.random()+"ie",a.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",this.activeX=a;var b=document.createElement("object");b.id="_Jazz"+Math.random(),b.type="audio/x-jazz",a.appendChild(b),this.objRef=b;var c=document.createElement("p");c.appendChild(document.createTextNode("This page requires the "));var d=document.createElement("a");d.appendChild(document.createTextNode("Jazz plugin")),d.href="http://jazz-soft.net/",c.appendChild(d),c.appendChild(document.createTextNode(".")),b.appendChild(c);var e=document.getElementById("MIDIPlugin");if(!e){var e=document.createElement("div");e.id="MIDIPlugin",e.style.position="absolute",e.style.visibility="hidden",e.style.left="-9999px",e.style.top="-9999px",document.body.appendChild(e)}e.appendChild(a),this.objRef.isJazz?this._Jazz=this.objRef:this.activeX.isJazz?this._Jazz=this.activeX:this._Jazz=null,this._Jazz&&(this._Jazz._jazzTimeZero=this._Jazz.Time(),this._Jazz._perfTimeZero=window.performance.now())}function d(){this._promise&&this._promise.fail({code:1})}function e(){this.jazz.MidiOutLong(this.data)}var f,g,h,i,j,k;b.prototype.then=function(a,b){this.accept=a,this.reject=b},b.prototype.succeed=function(a){this.accept&&this.accept(a)},b.prototype.fail=function(a){this.reject&&this.reject(a)},f=function(){var a=new g;return a._promise},g=function(){this._jazzInstances=new Array,this._jazzInstances.push(new c),this._promise=new b,this._jazzInstances[0]._Jazz?(this._Jazz=this._jazzInstances[0]._Jazz,window.setTimeout(h.bind(this),3)):window.setTimeout(d.bind(this),3)},h=function(){this._promise&&this._promise.succeed(this)},g.prototype.inputs=function(){if(!this._Jazz)return null;for(var a=this._Jazz.MidiInList(),b=new Array(a.length),c=0;c<a.length;c++)b[c]=new i(this,a[c],c);return b},g.prototype.outputs=function(){if(!this._Jazz)return null;for(var a=this._Jazz.MidiOutList(),b=new Array(a.length),c=0;c<a.length;c++)b[c]=new j(this,a[c],c);return b},i=function(a,b,d){this._listeners=[],this._midiAccess=a,this._index=d,this._inLongSysexMessage=!1,this._sysexBuffer=new Uint8Array,this.id=""+d+"."+b,this.manufacturer="",this.name=b,this.type="input",this.version="",this.onmidimessage=null;for(var e=null,f=0;f<a._jazzInstances.length&&!e;f++)a._jazzInstances[f].inputInUse||(e=a._jazzInstances[f]);e||(e=new c,a._jazzInstances.push(e)),e.inputInUse=!0,this._jazzInstance=e._Jazz,this._input=this._jazzInstance.MidiInOpen(this._index,k.bind(this))},i.prototype.addEventListener=function(a,b,c){if("midimessage"===a){for(var d=0;d<this._listeners.length;d++)if(this._listeners[d]==b)return;this._listeners.push(b)}},i.prototype.removeEventListener=function(a,b,c){if("midimessage"===a)for(var d=0;d<this._listeners.length;d++)if(this._listeners[d]==b)return void this._listeners.splice(d,1)},i.prototype.preventDefault=function(){this._pvtDef=!0},i.prototype.dispatchEvent=function(a){this._pvtDef=!1;for(var b=0;b<this._listeners.length;b++)this._listeners[b].handleEvent?this._listeners[b].handleEvent.bind(this)(a):this._listeners[b].bind(this)(a);return this.onmidimessage&&this.onmidimessage(a),this._pvtDef},i.prototype.appendToSysexBuffer=function(a){var b=this._sysexBuffer.length,c=new Uint8Array(b+a.length);c.set(this._sysexBuffer),c.set(a,b),this._sysexBuffer=c},i.prototype.bufferLongSysex=function(a,b){for(var c=b;c<a.length;){if(247==a[c])return c++,this.appendToSysexBuffer(a.slice(b,c)),c;c++}return this.appendToSysexBuffer(a.slice(b,c)),this._inLongSysexMessage=!0,c},k=function(a,b){var c,d=0,e=!1;for(c=0;c<b.length;c+=d){if(this._inLongSysexMessage){if(c=this.bufferLongSysex(b,c),247!=b[c-1])return;e=!0}else switch(e=!1,240&b[c]){case 128:case 144:case 160:case 176:case 224:d=3;break;case 192:case 208:d=2;break;case 240:switch(b[c]){case 240:if(c=this.bufferLongSysex(b,c),247!=b[c-1])return;e=!0;break;case 241:case 243:d=2;break;case 242:d=3;break;default:d=1}}var f=document.createEvent("Event");f.initEvent("midimessage",!1,!1),f.receivedTime=parseFloat(a.toString())+this._jazzInstance._perfTimeZero,e||this._inLongSysexMessage?(f.data=new Uint8Array(this._sysexBuffer),this._sysexBuffer=new Uint8Array(0),this._inLongSysexMessage=!1):f.data=new Uint8Array(b.slice(c,d+c)),this.dispatchEvent(f)}},j=function(a,b,d){this._listeners=[],this._midiAccess=a,this._index=d,this.id=""+d+"."+b,this.manufacturer="",this.name=b,this.type="output",this.version="";for(var e=null,f=0;f<a._jazzInstances.length&&!e;f++)a._jazzInstances[f].outputInUse||(e=a._jazzInstances[f]);e||(e=new c,a._jazzInstances.push(e)),e.outputInUse=!0,this._jazzInstance=e._Jazz,this._jazzInstance.MidiOutOpen(this.name)},j.prototype.send=function(a,b){var c=0;if(0===a.length)return!1;if(b&&(c=Math.floor(b-window.performance.now())),b&&c>1){var d=new Object;d.jazz=this._jazzInstance,d.data=a,window.setTimeout(e.bind(d),c)}else this._jazzInstance.MidiOutLong(a);return!0},window.navigator.requestMIDIAccess||(window.navigator.requestMIDIAccess=f)}(window),function(a){function b(){for(var b=["moz","webkit","o","ms"],c=b.length,d={value:function(a){return function(){return Date.now()-a}}(Date.now())};c>=0;c--)if(b[c]+"Now"in a.performance)return d.value=function(b){return function(){a.performance[b]()}}(b[c]+"Now"),d;return"timing"in a.performance&&"connectStart"in a.performance.timing&&(d.value=function(a){return function(){Date.now()-a}}(a.performance.timing.connectStart)),d}var c,d={};"performance"in a&&"now"in a.performance||("performance"in a||Object.defineProperty(a,"performance",{get:function(){return d}}),c=b(),Object.defineProperty(a.performance,"now",c))}(window);