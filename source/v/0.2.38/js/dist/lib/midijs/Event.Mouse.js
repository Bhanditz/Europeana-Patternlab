if("undefined"==typeof Event)var Event={};Event.drag=Event.dragElement=function(a){var b=a.element||document.body,c=b.ownerDocument;if("undefined"==typeof a.event)return void Event.add(b,"mousedown",function(b){a.event=b,Event.dragElement(a),Event.preventDefault(b),Event.stopPropagation(b)});var d={cancel:function(){Event.remove(c,"mousemove",e),Event.remove(c,"mouseup",f)}},e=function(b,c){"undefined"==typeof c&&(c="move");var e=Event.coords(b);switch(a.type){case"move":a.callback(b,{x:e.x+h-l,y:e.y+i-m},c,d);break;case"difference":a.callback(b,{x:e.x-h,y:e.y-i},c,d);break;case"relative":a.callback(b,{x:e.x-l,y:e.y-m},c,d);break;default:a.callback(b,{x:e.x,y:e.y},c,d)}},f=function(a){d.cancel(),e(a,"up")},g=abPos(b),h=g.x,i=g.y,j=a.event,k=Event.coords(j),l=k.x,m=k.y;return Event.add(c,"mousemove",e),Event.add(c,"mouseup",f),e(j,"down"),d},Event.coords=function(){return window.ActiveXObject?function(a){return{x:a.clientX+document.documentElement.scrollLeft,y:a.clientY+document.documentElement.scrollTop}}:function(a){return{x:a.pageX,y:a.pageY}}}(),Event.mousewheel=function(a,b,c){var d=0,e=Event(a,"mousewheel",function(a){a=a||window.event;var f=a.detail?-1*a.detail:a.wheelDelta/40;b(a,"wheel",f),window.clearInterval(d),d=window.setInterval(function(){window.clearInterval(d),b(a,"wheelup",f,e)},c||150)});return e};var abPos=function(a){a="object"==typeof a?a:document.getElementById(a);for(var b={x:0,y:0};null!=a;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b};