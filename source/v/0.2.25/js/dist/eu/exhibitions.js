define(["jquery"],function(a){function b(a){console.log("Exhibitions: "+a)}function c(){b("init"),f(),d(),e()}function d(){var b=[],c=a(".ve-foyer-card-state .text-box.description:not(.js-ellipsis)"),d=[];c.each(function(){a(this).addClass("js-ellipsis"),d.push(a(this))}),d.length>0&&require(["util_ellipsis"],function(c){for(var e=c.create(a(d)),f=0;f<e.length;f++)b.push(e[f])})}function e(){function b(a){var b=this;b.stateIndex=0,b.cardStates=a.find(".ve-foyer-card-state"),b.$el=a,a.find(".ve-card-nav-left").on("click",function(){b.left()}),a.find(".ve-card-nav-right").on("click",function(){b.right()}),this.prepNextShift()}b.prototype.updateButton=function(a){this.$el.find(".ve-state-button-on").removeClass("ve-state-button-on").addClass("ve-state-button-off"),this.$el.find(".ve-state-"+a).removeClass("ve-state-button-off").addClass("ve-state-button-on")},b.prototype.prepNextShift=function(b){var c=this.stateIndex==this.states.length-1?0:this.stateIndex+1,d=0==this.stateIndex?this.states.length-1:this.stateIndex-1;c=a(this.cardStates.get(c)),d=a(this.cardStates.get(d)),c.hasClass("hide-left")&&(c.removeClass("animating"),c.removeClass("hide-left"),c.addClass("hide-right")),d.hasClass("hide-right")&&(d.removeClass("animating"),d.removeClass("hide-right"),d.addClass("hide-left"))},b.prototype.shiftState=function(b){var c=a(this.cardStates.get(this.stateIndex));c.addClass("animating"),c.addClass(b>0?"hide-left":"hide-right");var d=this.stateIndex+b;d==this.states.length?d=0:0>d&&(d=this.states.length-1),this.stateIndex=d;var e=a(this.cardStates.get(this.stateIndex));e.removeClass("animating"),b>0?(e.addClass("hide-right"),e.removeClass("hide-left"),e.addClass("animating"),e.removeClass("hide-right")):(e.addClass("hide-left"),e.removeClass("hide-right"),e.addClass("animating"),e.removeClass("hide-left")),this.prepNextShift(),this.updateButton(this.stateIndex)},b.prototype.left=function(){this.shiftState(-1)},b.prototype.right=function(){this.shiftState(1)},b.prototype.states=["title","description","credits"],a(".ve-foyer-card").each(function(){new b(a(this))})}function f(){b("TODO: background-attachment:fixed on intro images"),a(window).width()>h?require(["ScrollMagic","TweenMax","util_resize"],function(c){require(["gsap"],function(){function d(b){a(".ve-progress-nav .ve-state-button-on").removeClass("ve-state-button-on").addClass("ve-state-button-off");var c=a(".ve-progress-nav .ve-state-button").get(b);a(c).addClass("ve-state-button-on").removeClass("ve-state-button-off")}g=new c.Controller,a(window).europeanaResize(function(){a(window).width()<=h&&!i&&(g.destroy(!0),g=null,i=!0,b("removed scroll-magic"))}),a(".ve-slide-container section").each(function(b,e){new c.Scene({triggerElement:this,triggerHook:"onCenter",offset:a(this).height()/2}).on("progress",function(){d(b)}).addTo(g)}),new c.Scene({triggerElement:"#ve-end",triggerHook:"onEnter"}).addTo(g).setTween(TweenMax.to(".ve-progress-nav",1,{right:"-1em",ease:Cubic.easeOut}))})}):b("too small for scroll-magic")}var g,h=768,i=!1;return{initPage:function(){c()}}});